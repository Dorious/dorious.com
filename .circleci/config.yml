version: 2
jobs:
  build:
    docker:
      - image: circleci/node:latest
    branches:
      only:
      - master
      - /rc-.*/
    working_directory: /tmp/dorious.com
    steps:
    - checkout
    - run: 
        name: Install NPM Modules
        command: npm install
    - run: npm run test
    - run: npm run build
    - run: npm pack
    - run: 
        name: Deployment to server
        command: scp dorious.com-*.tgz cirleci@dorious.com
